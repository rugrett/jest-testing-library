# Изучение Jest / Testing Library

Тесты нужны для проверки и утверждения результата выполнения программы, который мы ожидаем в конечном итоге,
описывая набор определенных требований и спецификаций к ПО.

- `Выгода - Доказательство рабочего кода, того, что ожидали`;
- `Статический анализ качества приложения`;
- `Комфортный рефакторинг и доработка нового функционала поверх старого`;
- `Снижение процента багов`;
- `Документация кода, его требование и спецификации`;

#### Виды тестирования && стратегии:

- unit - `дешевые`: **_функции_**, **_классы_**, **_модули_**, **_компоненты_**;
- интеграциионые - `средние`: проверка **сочитания** группы (модулей) unit тестов;
- end to end - `дорогие`: работа приложения в целом, имитирующее использование программы. _( клики, ввода данных в
  формы, переходы, отправки и тому подобное )_.
- ui тестирование

## Что такое jest?

* фреймворк для тестирования;
* для тестирования js/ts;
* структурируется и запускается с разными параметрами;
* отслеживает изменение кода с последующим запуском;
* расширяется с множеством плагинов и интегрируется в CI;
* огромный набор для утверждений;

## main fn

- ```describe``` для группировки тестов.
- ```test``` принимает 2 параметра, название и cb(() => test_case) - alias test
- ```it``` используется чаще, так как это обозначает глагол (действие) - alias test
- ```expect``` передаём результат в аргумент и предоставляет точечную анотацию утверждений;

#### Note
```jest default use CommonJS syntax```

```Настройки babel нужны для использования современного js;```

## Принцип
```
// AAA - arrange, act, assert
// AAA - Подготовка данных, действие и сравнение.
```

## CLI API
- [verbose](https://jestjs.io/docs/cli#--verbose): в моменте запуска показывает больше информации, если что-то идёт не по плану.

```typescript
function toBe<T>(equel: T, res: T) { equal === res }  //  equal === примитив
``` 

## Директория тестов

Три самых распространенных видов хранения тестов, но в каждой команде можно договариваться по своему;

- ```root/__tests__```
- ```root/src/__tests__```
- ```root/src/module/__tests__``` это может быть как и UI так и лююбой другой модуль в рамках директории.

## Свойства describe/it/test

- only: выполнять только этот тест, не только одно, но и сочитание кейсов === alias fit
- skip: пропустить этот тест, не только одно, но и сочитание кейсов === alias xit
- todo: описать то, что хотим сделать

## Хуки Jest

Для каждего кейса мы можем устанавливать свои setup хуки перед и после выполнением
- beforeAll = перед всеми тестами запустится 1 раз;
- afterAll = после всех тестов выполнится 1 раз;
- beforeEach = перед запуском конкретного сценария;
- afterEach = после запуском конкретного сценария;

note: лучше явно описывать для каждого describe свои сетапы хуков

## Моки
Директория обычно пишется как ```__mocks__```, но можно и по своему, главное понимать что это!

- Моки это объекты, имитируеющее реальное приложение;
  - полное;
  - упрощенное;
- Функции-фейки тестирование колбэков вызовов;
- spies - отслеживнаие метода и подмена результата;
- Имитация внешних модулей;